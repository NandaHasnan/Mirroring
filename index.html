<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Mirroring Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .mirror-bg {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        .mirror-screen {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
        }
        .mirror-screen:hover {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .phone-outline {
            position: relative;
            padding: 20px;
            border-radius: 30px;
            background: #222;
        }
        .phone-screen {
            border-radius: 8px;
            overflow: hidden;
        }
        .status-bar {
            height: 24px;
            background: rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            padding: 0 10px;
        }
        .notch {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 20px;
            background: #222;
            border-radius: 0 0 10px 10px;
            z-index: 10;
        }
        .url-display {
            border-radius: 8px;
            overflow: hidden;
        }
        @media (max-width: 768px) {
            .phone-outline {
                padding: 10px;
                border-radius: 20px;
            }
        }
    </style>
</head>
<body class="mirror-bg min-h-screen p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Phone Mirroring Portal</h1>
            <p class="text-gray-600 mt-2">View your phone screen remotely in real-time</p>
        </div>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Setup Section -->
            <div class="flex-1 bg-white rounded-lg p-6 shadow-lg">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Setup Your Mirror Session</h2>
                
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">Step 1: Generate Unique URL</label>
                    <button id="generateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg transition-colors">
                        Generate Mirroring Link
                    </button>
                </div>

                <div id="urlContainer" class="mb-6 hidden">
                    <label class="block text-gray-700 mb-2">Your Mirroring URL:</label>
                    <div class="flex">
                        <input id="mirrorUrl" type="text" class="flex-1 p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500" readonly>
                        <button id="copyBtn" class="bg-gray-200 hover:bg-gray-300 px-4 rounded-r-lg transition-colors">
                            Copy
                        </button>
                    </div>
                    <p class="text-sm text-gray-500 mt-2">Share this URL to view your phone screen remotely</p>
                </div>

                <div class="flex items-center justify-center">
                    <img src="https://placehold.co/370x260" alt="Illustration showing smartphone connecting to web browser with arrows indicating data transfer" class="rounded-lg">
                </div>
            </div>

            <!-- Preview Section -->
            <div class="flex-1 bg-white rounded-lg p-6 shadow-lg">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Mirror Screen Preview</h2>
                
                <div class="flex justify-center">
                    <div class="phone-outline">
                        <div class="notch"></div>
                        <div class="phone-screen">
                            <div class="status-bar flex justify-between text-white text-xs px-2">
                                <span class="time">12:34</span>
                                <div class="icons space-x-1">
                                    <span class="inline-block">ðŸ“¶</span>
                                    <span class="inline-block">ðŸ”‹</span>
                                </div>
                            </div>
                            <div id="mirrorView" class="bg-gray-100 flex items-center justify-center" style="height: 400px; width: 225px;">
                                <p id="defaultDisplay" class="text-gray-500 text-center p-4">Waiting for connection...</p>
                                <canvas id="screenCanvas" class="hidden"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <div id="statusDisplay" class="text-center text-gray-500">
                        Mirroring session not started
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="bg-white rounded-lg p-6 mt-8 shadow-lg">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">How to Use</h2>
            <ol class="list-decimal pl-5 space-y-2 text-gray-700">
                <li>Click "Generate Mirroring Link" to create a unique URL</li>
                <li>Open the generated URL on your smartphone</li>
                <li>Grant the necessary permissions when prompted</li>
                <li>Your phone screen will appear here automatically</li>
                <li>Share the URL with trusted people to view your screen</li>
            </ol>
            
            <div class="mt-6 flex justify-center">
                <img src="https://placehold.co/500x150" alt="Diagram showing smartphone connecting to desktop browser with security lock icons indicating secure connection" class="rounded-lg">
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const generateBtn = document.getElementById('generateBtn');
            const urlContainer = document.getElementById('urlContainer');
            const mirrorUrl = document.getElementById('mirrorUrl');
            const copyBtn = document.getElementById('copyBtn');
            const statusDisplay = document.getElementById('statusDisplay');
            const defaultDisplay = document.getElementById('defaultDisplay');
            const screenCanvas = document.getElementById('screenCanvas');
            const ctx = screenCanvas.getContext('2d');
            
            let socket;
            let sessionId = '';

            // Generate random session ID and URL
            generateBtn.addEventListener('click', function() {
                sessionId = generateSessionId();
                const baseUrl = `${window.location.origin}${window.location.pathname}`;
                const newUrl = `${baseUrl}?session=${sessionId}`;
                
                mirrorUrl.value = newUrl;
                urlContainer.classList.remove('hidden');
                
                // Create WebSocket connection
                setupWebSocket(sessionId);
                
                statusDisplay.textContent = `Waiting for connection to session: ${sessionId}`;
                statusDisplay.className = 'text-center text-blue-600';
                
                generateBtn.disabled = true;
                generateBtn.textContent = 'Session Active';
                generateBtn.className = 'w-full bg-gray-500 text-white py-3 px-4 rounded-lg cursor-not-allowed';
            });

            // Copy URL to clipboard
            copyBtn.addEventListener('click', function() {
                mirrorUrl.select();
                document.execCommand('copy');
                
                // Show feedback
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            });

            // Check for session in URL
            function checkExistingSession() {
                const params = new URLSearchParams(window.location.search);
                const existingSession = params.get('session');
                
                if (existingSession) {
                    sessionId = existingSession;
                    mirrorUrl.value = window.location.href;
                    urlContainer.classList.remove('hidden');
                    
                    setupWebSocket(sessionId);
                    
                    statusDisplay.textContent = `Connected to session: ${sessionId}`;
                    statusDisplay.className = 'text-center text-green-600';
                    
                    generateBtn.disabled = true;
                    generateBtn.textContent = 'Session Active';
                    generateBtn.className = 'w-full bg-gray-500 text-white py-3 px-4 rounded-lg cursor-not-allowed';
                    
                    // In a real app, this would initiate screen sharing from the phone
                    simulatePhoneConnection();
                }
            }
            
            // Initialize WebSocket connection
            function setupWebSocket(session) {
                // In a real implementation, replace with your WebSocket server URL
                const wsUrl = `wss://yourserver.com/mirror?session=${session}`;
                
                // Mock WebSocket for this demo
                console.log(`Connecting to WebSocket for session: ${session}`);
                
                // Simulate connection
                setTimeout(() => {
                    console.log('WebSocket connection established');
                }, 1000);
            }
            
            // Simulate phone connecting (for demo purposes)
            function simulatePhoneConnection() {
                setTimeout(() => {
                    defaultDisplay.classList.add('hidden');
                    screenCanvas.classList.remove('hidden');
                    screenCanvas.width = 225;
                    screenCanvas.height = 400;
                    
                    statusDisplay.textContent = 'Phone connected - Screen sharing active';
                    statusDisplay.className = 'text-center text-green-600';
                    
                    // Draw demo screen (would be phone screen in real implementation)
                    drawMockScreen();
                    
                    // Periodically update mock screen
                    setInterval(drawMockScreen, 3000);
                }, 2000);
            }
            
            // Draw mock phone screen (would be real phone screen in production)
            function drawMockScreen() {
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, screenCanvas.width, screenCanvas.height);
                
                // Draw some elements
                ctx.fillStyle = '#3498db';
                ctx.font = 'bold 16px Arial';
                ctx.fillText('Phone Screen Mirroring', 10, 30);
                
                ctx.fillStyle = '#2ecc71';
                ctx.font = '14px Arial';
                ctx.fillText('Battery: 85%', 10, 60);
                
                ctx.fillStyle = '#e74c3c';
                ctx.font = '14px Arial';
                ctx.fillText('Signal: Excellent', 10, 90);
                
                // Draw a random "app"
                const apps = ['Messages', 'Browser', 'Camera', 'Settings'];
                const randomApp = apps[Math.floor(Math.random() * apps.length)];
                
                ctx.fillStyle = '#9b59b6';
                ctx.font = 'bold 18px Arial';
                ctx.fillText(randomApp, 10, 150);
                
                // Draw a notification
                ctx.fillStyle = '#f1c40f';
                ctx.beginPath();
                ctx.arc(200, 120, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#000000';
                ctx.font = '12px Arial';
                ctx.fillText('1', 197, 125);
            }
            
            // Generate random session ID
            function generateSessionId() {
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c === 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
            }
            
            // Check for existing session on page load
            checkExistingSession();
        });
    </script>
</body>
</html>
